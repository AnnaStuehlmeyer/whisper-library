<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Whisper Library: whisper_library::NetworkConnector Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Whisper Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classwhisper__library_1_1NetworkConnector.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classwhisper__library_1_1NetworkConnector-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">whisper_library::NetworkConnector Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classwhisper__library_1_1NetworkConnector.html" title="NetworkConnector can send Packets to the Network. ">NetworkConnector</a> can send Packets to the Network.  
 <a href="classwhisper__library_1_1NetworkConnector.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a475ec0b51be664a2f710cd3b902b2b5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a475ec0b51be664a2f710cd3b902b2b5d">NetworkConnector</a> (function&lt; void(string, <a class="el" href="classwhisper__library_1_1GenericPacket.html">GenericPacket</a>)&gt; packet_received)</td></tr>
<tr class="memdesc:a475ec0b51be664a2f710cd3b902b2b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of <a class="el" href="classwhisper__library_1_1NetworkConnector.html" title="NetworkConnector can send Packets to the Network. ">NetworkConnector</a>.  <a href="#a475ec0b51be664a2f710cd3b902b2b5d">More...</a><br/></td></tr>
<tr class="separator:a475ec0b51be664a2f710cd3b902b2b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa092a0258568f642f8375471612c78e6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa092a0258568f642f8375471612c78e6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#aa092a0258568f642f8375471612c78e6">~NetworkConnector</a> ()</td></tr>
<tr class="memdesc:aa092a0258568f642f8375471612c78e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor of <a class="el" href="classwhisper__library_1_1NetworkConnector.html" title="NetworkConnector can send Packets to the Network. ">NetworkConnector</a>. <br/></td></tr>
<tr class="separator:aa092a0258568f642f8375471612c78e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61fc5a52a92b005f4438c4debf5edba1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a61fc5a52a92b005f4438c4debf5edba1">sendTcp</a> (string ip, <a class="el" href="classwhisper__library_1_1TcpPacket.html">TcpPacket</a> packet)</td></tr>
<tr class="memdesc:a61fc5a52a92b005f4438c4debf5edba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a tcp packet to a specific ip.  <a href="#a61fc5a52a92b005f4438c4debf5edba1">More...</a><br/></td></tr>
<tr class="separator:a61fc5a52a92b005f4438c4debf5edba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac428e499e785d7eda63ddc1f2119ef88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#ac428e499e785d7eda63ddc1f2119ef88">sendUdp</a> (string ip, <a class="el" href="classwhisper__library_1_1UdpPacket.html">UdpPacket</a> packet)</td></tr>
<tr class="memdesc:ac428e499e785d7eda63ddc1f2119ef88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a udp packet to a specific ip.  <a href="#ac428e499e785d7eda63ddc1f2119ef88">More...</a><br/></td></tr>
<tr class="separator:ac428e499e785d7eda63ddc1f2119ef88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126f734db4e5ed7ea9ba5f5b69ad0050"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a126f734db4e5ed7ea9ba5f5b69ad0050">openListener</a> (string ip, <a class="el" href="classwhisper__library_1_1CovertChannel.html">CovertChannel</a> *channel)</td></tr>
<tr class="memdesc:a126f734db4e5ed7ea9ba5f5b69ad0050"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens a network listener for packets of a specific ip and covert channel.  <a href="#a126f734db4e5ed7ea9ba5f5b69ad0050">More...</a><br/></td></tr>
<tr class="separator:a126f734db4e5ed7ea9ba5f5b69ad0050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3494e950c1e15b3f2a156a63be079153"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a3494e950c1e15b3f2a156a63be079153">closeListener</a> (string ip)</td></tr>
<tr class="memdesc:a3494e950c1e15b3f2a156a63be079153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes the network listener for a specific ip.  <a href="#a3494e950c1e15b3f2a156a63be079153">More...</a><br/></td></tr>
<tr class="separator:a3494e950c1e15b3f2a156a63be079153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490aa70f194809b4a700bceb2f0c467a"><td class="memItemLeft" align="right" valign="top">vector&lt; string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a490aa70f194809b4a700bceb2f0c467a">adapters</a> ()</td></tr>
<tr class="memdesc:a490aa70f194809b4a700bceb2f0c467a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector with available network adapters.  <a href="#a490aa70f194809b4a700bceb2f0c467a">More...</a><br/></td></tr>
<tr class="separator:a490aa70f194809b4a700bceb2f0c467a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cb0e2998c87b5bac132faf629ae0677"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3cb0e2998c87b5bac132faf629ae0677"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a3cb0e2998c87b5bac132faf629ae0677">adapterCount</a> ()</td></tr>
<tr class="memdesc:a3cb0e2998c87b5bac132faf629ae0677"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of avaiable network adapters. <br/></td></tr>
<tr class="separator:a3cb0e2998c87b5bac132faf629ae0677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d89b63fc05ab3266192d222df8720ca"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a2d89b63fc05ab3266192d222df8720ca">setAdapter</a> (string adapter_name)</td></tr>
<tr class="memdesc:a2d89b63fc05ab3266192d222df8720ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the adapter that is used to listen for packets and send them (sending win32 only).  <a href="#a2d89b63fc05ab3266192d222df8720ca">More...</a><br/></td></tr>
<tr class="separator:a2d89b63fc05ab3266192d222df8720ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91edc291a8e5af599039c74166ed89e5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a91edc291a8e5af599039c74166ed89e5"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a91edc291a8e5af599039c74166ed89e5">currentAdapter</a> ()</td></tr>
<tr class="memdesc:a91edc291a8e5af599039c74166ed89e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the currently selected adapter name. <br/></td></tr>
<tr class="separator:a91edc291a8e5af599039c74166ed89e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3880fea0760e79dd27762c7c7521cd30"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a3880fea0760e79dd27762c7c7521cd30">adapterDescription</a> (string adapter_name)</td></tr>
<tr class="memdesc:a3880fea0760e79dd27762c7c7521cd30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the description of a given network adapter.  <a href="#a3880fea0760e79dd27762c7c7521cd30">More...</a><br/></td></tr>
<tr class="separator:a3880fea0760e79dd27762c7c7521cd30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaf84d919d080b210815f4b740dd92c8"><td class="memItemLeft" align="right" valign="top">vector&lt; string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#adaf84d919d080b210815f4b740dd92c8">adapterAddresses</a> (string adapter_name)</td></tr>
<tr class="memdesc:adaf84d919d080b210815f4b740dd92c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector with all network addesses of an adapter.  <a href="#adaf84d919d080b210815f4b740dd92c8">More...</a><br/></td></tr>
<tr class="separator:adaf84d919d080b210815f4b740dd92c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a12e859701bcb08bed472930ec4960331"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a12e859701bcb08bed472930ec4960331">retrievePacket</a> ()</td></tr>
<tr class="memdesc:a12e859701bcb08bed472930ec4960331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loop that retrieves packets from the selected network adapter.  <a href="#a12e859701bcb08bed472930ec4960331">More...</a><br/></td></tr>
<tr class="separator:a12e859701bcb08bed472930ec4960331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be281d49a7266854999055ae8928f6f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a2be281d49a7266854999055ae8928f6f">validIPv4</a> (string ip)</td></tr>
<tr class="memdesc:a2be281d49a7266854999055ae8928f6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given ip is a valid IPv4 address.  <a href="#a2be281d49a7266854999055ae8928f6f">More...</a><br/></td></tr>
<tr class="separator:a2be281d49a7266854999055ae8928f6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a157f7828d444bb695a6da6bf9f47ca37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a157f7828d444bb695a6da6bf9f47ca37">addFilter</a> (string ip, unsigned short port, string protocol)</td></tr>
<tr class="memdesc:a157f7828d444bb695a6da6bf9f47ca37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a capture filter for the opened adapter.  <a href="#a157f7828d444bb695a6da6bf9f47ca37">More...</a><br/></td></tr>
<tr class="separator:a157f7828d444bb695a6da6bf9f47ca37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad629db312fca8d41066b8f3272af5c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#aad629db312fca8d41066b8f3272af5c4">removeFilter</a> (string ip)</td></tr>
<tr class="memdesc:aad629db312fca8d41066b8f3272af5c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes a capture filter.  <a href="#aad629db312fca8d41066b8f3272af5c4">More...</a><br/></td></tr>
<tr class="separator:aad629db312fca8d41066b8f3272af5c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf297b22854d9fc2b8a217cceebe9123"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adf297b22854d9fc2b8a217cceebe9123"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#adf297b22854d9fc2b8a217cceebe9123">rebuildFilter</a> ()</td></tr>
<tr class="memdesc:adf297b22854d9fc2b8a217cceebe9123"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has to be called when the filter map 'm_filter' has changed to refresh the capture filter. <br/></td></tr>
<tr class="separator:adf297b22854d9fc2b8a217cceebe9123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa270b0dfe4d9e4baeb9a7fc49cffbee7"><td class="memItemLeft" align="right" valign="top">vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#aa270b0dfe4d9e4baeb9a7fc49cffbee7">switchEndian</a> (vector&lt; bool &gt; binary)</td></tr>
<tr class="memdesc:aa270b0dfe4d9e4baeb9a7fc49cffbee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switches binary from big endian to little endian and the other way around.  <a href="#aa270b0dfe4d9e4baeb9a7fc49cffbee7">More...</a><br/></td></tr>
<tr class="separator:aa270b0dfe4d9e4baeb9a7fc49cffbee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4b8b0ac437539e2a36858c209933ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#ace4b8b0ac437539e2a36858c209933ad">packetReceived</a> (vector&lt; bool &gt; packet_data)</td></tr>
<tr class="memdesc:ace4b8b0ac437539e2a36858c209933ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is called in a new thread when a packet is received.  <a href="#ace4b8b0ac437539e2a36858c209933ad">More...</a><br/></td></tr>
<tr class="separator:ace4b8b0ac437539e2a36858c209933ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a93aa4206b3c1170c7173da53b0fb34dc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93aa4206b3c1170c7173da53b0fb34dc"></a>
<a class="el" href="classwhisper__library_1_1PcapWrapper.html">PcapWrapper</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a93aa4206b3c1170c7173da53b0fb34dc">m_pcap</a></td></tr>
<tr class="memdesc:a93aa4206b3c1170c7173da53b0fb34dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the pcap wrapper. Is used to listen for packets and sending packets. <br/></td></tr>
<tr class="separator:a93aa4206b3c1170c7173da53b0fb34dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc55c308b4c35764d8e494989f34481"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adcc55c308b4c35764d8e494989f34481"></a>
<a class="el" href="classwhisper__library_1_1SocketSender.html">SocketSender</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#adcc55c308b4c35764d8e494989f34481">m_socket</a></td></tr>
<tr class="memdesc:adcc55c308b4c35764d8e494989f34481"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to a socket class. Is used to send packets using a raw socket. <br/></td></tr>
<tr class="separator:adcc55c308b4c35764d8e494989f34481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeefe2b6a43a45e106b905a3fadef55a2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeefe2b6a43a45e106b905a3fadef55a2"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#aeefe2b6a43a45e106b905a3fadef55a2">m_source_ip</a></td></tr>
<tr class="memdesc:aeefe2b6a43a45e106b905a3fadef55a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">your own ip (ipv4), is set after changing the adapter (setAdapter) <br/></td></tr>
<tr class="separator:aeefe2b6a43a45e106b905a3fadef55a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45797ef064a63576f9a87bd155c19e92"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a45797ef064a63576f9a87bd155c19e92"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a45797ef064a63576f9a87bd155c19e92">m_connection_count</a></td></tr>
<tr class="memdesc:a45797ef064a63576f9a87bd155c19e92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts the number of open connections. <br/></td></tr>
<tr class="separator:a45797ef064a63576f9a87bd155c19e92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f6350d66d53c3737387d004d61edeb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3f6350d66d53c3737387d004d61edeb"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#ae3f6350d66d53c3737387d004d61edeb">m_adapter</a></td></tr>
<tr class="memdesc:ae3f6350d66d53c3737387d004d61edeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the unique adapter name, that is currently selected. <br/></td></tr>
<tr class="separator:ae3f6350d66d53c3737387d004d61edeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e86159d2cccc4e072fe5251d9d8c82e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e86159d2cccc4e072fe5251d9d8c82e"></a>
atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a4e86159d2cccc4e072fe5251d9d8c82e">m_adapter_open</a></td></tr>
<tr class="memdesc:a4e86159d2cccc4e072fe5251d9d8c82e"><td class="mdescLeft">&#160;</td><td class="mdescRight">True, if a network adapter is open. Otherwise false. <br/></td></tr>
<tr class="separator:a4e86159d2cccc4e072fe5251d9d8c82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f7ca4f08b641489701d6016004d41ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f7ca4f08b641489701d6016004d41ba"></a>
map&lt; string, string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#a0f7ca4f08b641489701d6016004d41ba">m_filter</a></td></tr>
<tr class="memdesc:a0f7ca4f08b641489701d6016004d41ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">map, that stores the capture filter rule for every ip. The key is the ip, the capture filter belongs to. <br/></td></tr>
<tr class="separator:a0f7ca4f08b641489701d6016004d41ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa519aac221de968af2cc1a5773d4def8"><td class="memItemLeft" align="right" valign="top">function&lt; void(string, <br class="typebreak"/>
<a class="el" href="classwhisper__library_1_1GenericPacket.html">GenericPacket</a>)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwhisper__library_1_1NetworkConnector.html#aa519aac221de968af2cc1a5773d4def8">m_packet_received</a></td></tr>
<tr class="separator:aa519aac221de968af2cc1a5773d4def8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classwhisper__library_1_1NetworkConnector.html" title="NetworkConnector can send Packets to the Network. ">NetworkConnector</a> can send Packets to the Network. </p>
<p>A <a class="el" href="classwhisper__library_1_1NetworkConnector.html" title="NetworkConnector can send Packets to the Network. ">NetworkConnector</a> is used by the <a class="el" href="classwhisper__library_1_1ChannelManager.html" title="The connecting part for the CovertChannel and the framework. ">ChannelManager</a> to send packets. It can be configured to use a specific network adapter and listen to packets from specific Ip addresses. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a475ec0b51be664a2f710cd3b902b2b5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">whisper_library::NetworkConnector::NetworkConnector </td>
          <td>(</td>
          <td class="paramtype">function&lt; void(string, <a class="el" href="classwhisper__library_1_1GenericPacket.html">GenericPacket</a>)&gt;&#160;</td>
          <td class="paramname"><em>packet_received</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor of <a class="el" href="classwhisper__library_1_1NetworkConnector.html" title="NetworkConnector can send Packets to the Network. ">NetworkConnector</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet_received</td><td>Callback function that is called, when a packet arrived over network. The first parameter is the ip it was sent from, the second parameter is the application layer part of the packet in a generic format. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="adaf84d919d080b210815f4b740dd92c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; whisper_library::NetworkConnector::adapterAddresses </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>adapter_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a vector with all network addesses of an adapter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adapter_name</td><td>Unique name of the adapter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of network addresses of the currently selected adapter </dd></dl>

</div>
</div>
<a class="anchor" id="a3880fea0760e79dd27762c7c7521cd30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string whisper_library::NetworkConnector::adapterDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>adapter_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the description of a given network adapter. </p>
<p>Returns the description of a given network adapter. The unique names of the adapters can be retrieved by calling 'adapters'. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adapter_name</td><td>Unique name of the adapter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Description of the adapter. Is empty ("") if the adapter_name wasn't found or the description is NULL. </dd></dl>

</div>
</div>
<a class="anchor" id="a490aa70f194809b4a700bceb2f0c467a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; string &gt; whisper_library::NetworkConnector::adapters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a vector with available network adapters. </p>
<p>Returns a vector with all available network adapter names. The name uniquely identifies the network adapter and is used to select it with 'setAdapter'.</p>
<dl class="section return"><dt>Returns</dt><dd>Vector with all available network adapter names. </dd></dl>

</div>
</div>
<a class="anchor" id="a157f7828d444bb695a6da6bf9f47ca37"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::addFilter </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>protocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a capture filter for the opened adapter. </p>
<p>Only packets with matching ip, port and protocol are received. Multiple filters are linked with 'or'. /param ip The ip, that packets are received from in dotted form /param port the port, that received packets should have /param protocol the protocol, that received packets should have </p>

</div>
</div>
<a class="anchor" id="a3494e950c1e15b3f2a156a63be079153"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::closeListener </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes the network listener for a specific ip. </p>
<p>Stops listening for packets coming from the given ip. If no open connection remains, the network adapter is closed. </p>

</div>
</div>
<a class="anchor" id="a126f734db4e5ed7ea9ba5f5b69ad0050"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool whisper_library::NetworkConnector::openListener </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classwhisper__library_1_1CovertChannel.html">CovertChannel</a> *&#160;</td>
          <td class="paramname"><em>channel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a network listener for packets of a specific ip and covert channel. </p>
<p>Opens a network adapter that has to be set via 'setAdapter' and listens for packets that are received from the given ip, port and protocol as specified in the covert channel. The listener is started in a seperate thread. Received packets are returned with the callback method set in the constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>The destination IP of the connection </td></tr>
    <tr><td class="paramname">channel</td><td>The covert channel that is used for the connection </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the packet listener was started succesfully, otherwise false. </dd></dl>

</div>
</div>
<a class="anchor" id="ace4b8b0ac437539e2a36858c209933ad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::packetReceived </td>
          <td>(</td>
          <td class="paramtype">vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>packet_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is called in a new thread when a packet is received. </p>
<p>The function extracts the application layer header and data from the complete frame and transforms it to little endian. It then calls the callback function m_packet_received to give the packet back to the channelmanager.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet_data</td><td>binary representation of a complete frame, that was retrieved from an adapter </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aad629db312fca8d41066b8f3272af5c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::removeFilter </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes a capture filter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>the ip, that you no longer want to receive messages from </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a12e859701bcb08bed472930ec4960331"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::retrievePacket </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Loop that retrieves packets from the selected network adapter. </p>
<p>Starts a loop that runs as long as an adapter is open. It retrieves packets from the selected adapter and forwards the application layer part via the callback function m_packet_received, that is set in the constructor. Packets are retrieved with a maximum delay of 1 ms. </p>

</div>
</div>
<a class="anchor" id="a61fc5a52a92b005f4438c4debf5edba1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::sendTcp </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classwhisper__library_1_1TcpPacket.html">TcpPacket</a>&#160;</td>
          <td class="paramname"><em>packet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a tcp packet to a specific ip. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>The ip the packet is send to. </td></tr>
    <tr><td class="paramname">packet</td><td>The tcp packet that is send over network. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac428e499e785d7eda63ddc1f2119ef88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void whisper_library::NetworkConnector::sendUdp </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classwhisper__library_1_1UdpPacket.html">UdpPacket</a>&#160;</td>
          <td class="paramname"><em>packet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a udp packet to a specific ip. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>The ip the packet is send to. </td></tr>
    <tr><td class="paramname">packet</td><td>The udp packet that is send over network. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2d89b63fc05ab3266192d222df8720ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool whisper_library::NetworkConnector::setAdapter </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>adapter_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the adapter that is used to listen for packets and send them (sending win32 only). </p>
<p>Sets the network adapter that is used to listen for incoming packets. Has no effect if an adapter is open. Sending tcp using that adapter is only available on win32 using wpcap. The unique names of the adapters can be retrieved by calling 'adapters'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adapter_name</td><td>Unique name of the adapter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the adapter name exists and owns a valid ipv4 address, otherwise false </dd></dl>

</div>
</div>
<a class="anchor" id="aa270b0dfe4d9e4baeb9a7fc49cffbee7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; bool &gt; whisper_library::NetworkConnector::switchEndian </td>
          <td>(</td>
          <td class="paramtype">vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>binary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Switches binary from big endian to little endian and the other way around. </p>
<dl class="section return"><dt>Returns</dt><dd>Vector that contains the switched binary </dd></dl>

</div>
</div>
<a class="anchor" id="a2be281d49a7266854999055ae8928f6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool whisper_library::NetworkConnector::validIPv4 </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the given ip is a valid IPv4 address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>The ip to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the ip is a valid Ipv4 address, otherwise false </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa519aac221de968af2cc1a5773d4def8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">function&lt;void(string, <a class="el" href="classwhisper__library_1_1GenericPacket.html">GenericPacket</a>)&gt; whisper_library::NetworkConnector::m_packet_received</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Callback method that is called, when a new packet arrived. First parameter is the ip it was sent from, the second is the application layer part of the packet in a generic format </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>whisper_library</b></li><li class="navelem"><a class="el" href="classwhisper__library_1_1NetworkConnector.html">NetworkConnector</a></li>
    <li class="footer">Generated on Mon Apr 7 2014 12:09:18 for Whisper Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
